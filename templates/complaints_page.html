{% extends "base.html" %}
{% block content %}
<h3>Complaints</h3>
<form method="post">
  {{ form.hidden_tag() }}
  <div class="mb-2">{{ form.subject.label }} {{ form.subject(class="form-control") }}</div>
  <div class="mb-2">{{ form.message.label }} {{ form.message(class="form-control", rows=4) }}</div>
  <div>{{ form.submit(class="btn btn-warning") }}</div>
</form>

<hr>
<ul class="list-group">
  {% for c in complaints %}
    <li class="list-group-item">
      <strong>{{ c.subject }}</strong> â€” {{ c.message }} <br>
      <small>By {{ c.user.email }} on {{ c.created_at.strftime("%Y-%m-%d %H:%M") }} | Status: {{ c.status }}</small>
      {% if current_user.role in ["admin","warden"] %}
        <form method="post" action="{{ url_for('toggle_complaint', c_id=c.id) }}" style="display:inline">
          <button class="btn btn-sm btn-outline-success float-end">Toggle</button>
        </form>
      {% endif %}
    </li>
  {% endfor %}
</ul>
{% endblock %}
